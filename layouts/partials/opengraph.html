{{- $title := .Title }}
{{- $description := .Description | default .Summary | default .Site.Params.description | plainify | htmlUnescape | truncate 200 }}
{{- $image := "" }}
{{- $imageWidth := 1200 }}
{{- $imageHeight := 630 }}

{{/* Find featured image */}}
{{- with .Params.image }}
  {{- $image = . }}
{{- else }}
  {{- with .Resources.GetMatch "featured*" }}
    {{- $image = .RelPermalink }}
  {{- else }}
    {{- with $.Site.Params.ogImage }}
      {{- $image = . }}
    {{- end }}
  {{- end }}
{{- end }}

{{/* Open Graph */}}
<meta property="og:title" content="{{ $title }}">
<meta property="og:description" content="{{ $description }}">
<meta property="og:type" content="{{ if .IsPage }}article{{ else }}website{{ end }}">
<meta property="og:url" content="{{ .Permalink }}">
<meta property="og:site_name" content="{{ .Site.Title }}">
<meta property="og:locale" content="{{ .Language.Lang }}">

{{- range .Translations }}
<meta property="og:locale:alternate" content="{{ .Language.Lang }}">
{{- end }}

{{- with $image }}
<meta property="og:image" content="{{ . | absURL }}">
<meta property="og:image:width" content="{{ $imageWidth }}">
<meta property="og:image:height" content="{{ $imageHeight }}">
{{- end }}

{{/* Article specific */}}
{{- if .IsPage }}
{{- with .PublishDate }}
<meta property="article:published_time" content="{{ .Format "2006-01-02T15:04:05Z07:00" }}">
{{- end }}
{{- with .Lastmod }}
<meta property="article:modified_time" content="{{ .Format "2006-01-02T15:04:05Z07:00" }}">
{{- end }}
{{- with .Params.author }}
<meta property="article:author" content="{{ . }}">
{{- end }}
{{- with .Params.tags }}
{{- range . }}
<meta property="article:tag" content="{{ . }}">
{{- end }}
{{- end }}
{{- end }}

{{/* Twitter Card */}}
<meta name="twitter:card" content="{{ if $image }}summary_large_image{{ else }}summary{{ end }}">
<meta name="twitter:title" content="{{ $title }}">
<meta name="twitter:description" content="{{ $description }}">
{{- with $image }}
<meta name="twitter:image" content="{{ . | absURL }}">
{{- end }}
{{- with .Site.Params.twitterHandle }}
<meta name="twitter:site" content="@{{ . }}">
<meta name="twitter:creator" content="@{{ . }}">
{{- end }}
