<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 380">
  <defs>
    <style>
      .text { font-family: 'Segoe UI', Arial, sans-serif; }
      .title { font-size: 18px; font-weight: bold; fill: #e0e0e0; }
      .label { font-size: 11px; fill: #ccc; }
      .node { fill: #2a3a5a; stroke: #4A90D9; stroke-width: 1.5; }
      .op { fill: #3a2a5a; stroke: #9B59B6; stroke-width: 1.5; }
    </style>
    <marker id="arrow-f" markerWidth="7" markerHeight="5" refX="7" refY="2.5" orient="auto">
      <path d="M0,0 L7,2.5 L0,5" fill="#4A90D9"/>
    </marker>
    <marker id="arrow-b" markerWidth="7" markerHeight="5" refX="0" refY="2.5" orient="auto">
      <path d="M7,0 L0,2.5 L7,5" fill="#E74C3C"/>
    </marker>
  </defs>

  <rect width="700" height="380" fill="#1a1a2e" rx="8"/>
  <text x="350" y="32" text-anchor="middle" class="text title">계산 그래프 (Computation Graph)</text>
  <text x="350" y="52" text-anchor="middle" class="text" fill="#888" font-size="12">w = x*y + x,  loss = w²</text>

  <!-- === Forward Pass (top) === -->
  <text x="40" y="85" class="text" fill="#4A90D9" font-size="12" font-weight="bold">Forward</text>

  <!-- Input nodes -->
  <circle cx="100" cy="130" r="28" class="node"/>
  <text x="100" y="127" text-anchor="middle" class="text" fill="#fff" font-size="12" font-weight="bold">x</text>
  <text x="100" y="142" text-anchor="middle" class="text" fill="#4A90D9" font-size="10">= 2</text>

  <circle cx="100" cy="220" r="28" class="node"/>
  <text x="100" y="217" text-anchor="middle" class="text" fill="#fff" font-size="12" font-weight="bold">y</text>
  <text x="100" y="232" text-anchor="middle" class="text" fill="#4A90D9" font-size="10">= 3</text>

  <!-- Multiply node -->
  <circle cx="250" cy="175" r="25" class="op"/>
  <text x="250" y="179" text-anchor="middle" class="text" fill="#fff" font-size="16" font-weight="bold">×</text>

  <!-- Edges to multiply -->
  <line x1="128" y1="140" x2="225" y2="168" stroke="#4A90D9" stroke-width="1.5" marker-end="url(#arrow-f)"/>
  <line x1="128" y1="210" x2="225" y2="182" stroke="#4A90D9" stroke-width="1.5" marker-end="url(#arrow-f)"/>

  <!-- z = x*y -->
  <circle cx="370" cy="175" r="28" class="node"/>
  <text x="370" y="172" text-anchor="middle" class="text" fill="#fff" font-size="12" font-weight="bold">z</text>
  <text x="370" y="187" text-anchor="middle" class="text" fill="#4A90D9" font-size="10">= 6</text>

  <line x1="275" y1="175" x2="342" y2="175" stroke="#4A90D9" stroke-width="1.5" marker-end="url(#arrow-f)"/>

  <!-- Add node -->
  <circle cx="450" cy="140" r="25" class="op"/>
  <text x="450" y="145" text-anchor="middle" class="text" fill="#fff" font-size="16" font-weight="bold">+</text>

  <!-- z to add -->
  <line x1="398" y1="168" x2="425" y2="148" stroke="#4A90D9" stroke-width="1.5" marker-end="url(#arrow-f)"/>

  <!-- x to add (skip) -->
  <path d="M128,125 Q200,80 430,130" fill="none" stroke="#4A90D9" stroke-width="1.5" marker-end="url(#arrow-f)"/>
  <text x="270" y="90" text-anchor="middle" class="text" fill="#4A90D9" font-size="9">x도 직접 연결</text>

  <!-- w = z + x -->
  <circle cx="540" cy="140" r="28" class="node"/>
  <text x="540" y="137" text-anchor="middle" class="text" fill="#fff" font-size="12" font-weight="bold">w</text>
  <text x="540" y="152" text-anchor="middle" class="text" fill="#4A90D9" font-size="10">= 8</text>

  <line x1="475" y1="140" x2="512" y2="140" stroke="#4A90D9" stroke-width="1.5" marker-end="url(#arrow-f)"/>

  <!-- Square node -->
  <circle cx="620" cy="140" r="22" class="op"/>
  <text x="620" y="145" text-anchor="middle" class="text" fill="#fff" font-size="14" font-weight="bold">²</text>

  <line x1="568" y1="140" x2="598" y2="140" stroke="#4A90D9" stroke-width="1.5" marker-end="url(#arrow-f)"/>

  <!-- Loss -->
  <circle cx="670" cy="140" r="20" fill="#5a2a2a" stroke="#E67E22" stroke-width="2"/>
  <text x="670" y="137" text-anchor="middle" class="text" fill="#E67E22" font-size="10" font-weight="bold">L</text>
  <text x="670" y="150" text-anchor="middle" class="text" fill="#E67E22" font-size="9">64</text>

  <line x1="642" y1="140" x2="650" y2="140" stroke="#E67E22" stroke-width="1.5"/>

  <!-- === Backward Pass (bottom) === -->
  <rect x="20" y="260" width="660" height="110" fill="#252545" rx="8"/>
  <text x="40" y="285" class="text" fill="#E74C3C" font-size="12" font-weight="bold">Backward (각 노드의 local gradient)</text>

  <!-- Backward computations -->
  <rect x="40" y="295" width="120" height="60" fill="#1a1a2e" rx="6" stroke="#9B59B6" stroke-width="1"/>
  <text x="100" y="313" text-anchor="middle" class="text" fill="#9B59B6" font-size="10" font-weight="bold">² 노드</text>
  <text x="100" y="330" text-anchor="middle" class="text" fill="#ccc" font-size="10">∂L/∂w = 2w</text>
  <text x="100" y="347" text-anchor="middle" class="text" fill="#E74C3C" font-size="10">= 2×8 = 16</text>

  <rect x="180" y="295" width="120" height="60" fill="#1a1a2e" rx="6" stroke="#9B59B6" stroke-width="1"/>
  <text x="240" y="313" text-anchor="middle" class="text" fill="#9B59B6" font-size="10" font-weight="bold">+ 노드</text>
  <text x="240" y="330" text-anchor="middle" class="text" fill="#ccc" font-size="10">∂w/∂z = 1, ∂w/∂x = 1</text>
  <text x="240" y="347" text-anchor="middle" class="text" fill="#E74C3C" font-size="10">그대로 전달</text>

  <rect x="320" y="295" width="120" height="60" fill="#1a1a2e" rx="6" stroke="#9B59B6" stroke-width="1"/>
  <text x="380" y="313" text-anchor="middle" class="text" fill="#9B59B6" font-size="10" font-weight="bold">× 노드</text>
  <text x="380" y="330" text-anchor="middle" class="text" fill="#ccc" font-size="10">∂z/∂x = y, ∂z/∂y = x</text>
  <text x="380" y="347" text-anchor="middle" class="text" fill="#E74C3C" font-size="10">서로 교환!</text>

  <!-- Final results -->
  <rect x="460" y="295" width="200" height="60" fill="#1a1a2e" rx="6" stroke="#E74C3C" stroke-width="1.5"/>
  <text x="560" y="313" text-anchor="middle" class="text" fill="#E74C3C" font-size="11" font-weight="bold">최종 결과</text>
  <text x="560" y="332" text-anchor="middle" class="text" fill="#fff" font-size="11">∂L/∂x = 16×(3+1) = 64</text>
  <text x="560" y="350" text-anchor="middle" class="text" fill="#fff" font-size="11">∂L/∂y = 16×2 = 32</text>
</svg>