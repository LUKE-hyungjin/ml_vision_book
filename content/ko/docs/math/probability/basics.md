---
title: "확률의 기초"
weight: 1
math: true
---

# 확률의 기초 (Probability Basics)

{{% hint info %}}
**선수지식**: 없음 (처음부터 시작합니다!)
{{% /hint %}}

## 한 줄 요약

> **"불확실한 것을 숫자로 표현하는 방법"**

---

## 왜 확률을 배워야 하나요?

### 문제 상황: AI에게 "고양이인가요?" 물어보기

사진을 보여주고 "이게 고양이야?"라고 물으면, AI는 뭐라고 대답해야 할까요?

```
질문: "이 사진이 고양이인가요?"

나쁜 대답: "네" 또는 "아니요"  (확신이 없어도 하나만 선택)
좋은 대답: "95% 확률로 고양이입니다"  (불확실성 표현!)
```

**핵심**: 세상은 불확실합니다. 확률은 그 불확실성을 **숫자**로 표현하는 도구입니다.

---

## 1. 확률이란?

### 직관적 정의

> 확률 = **"어떤 일이 일어날 가능성"**을 0과 1 사이의 숫자로 표현한 것

- **0**: 절대 안 일어남 (불가능)
- **1**: 반드시 일어남 (확실)
- **0.5**: 반반 (동전 던지기)

### 예시

| 상황 | 확률 | 의미 |
|------|------|------|
| 동전 앞면 | 0.5 (50%) | 반반 |
| 주사위 1 나옴 | 0.167 (1/6) | 6번 중 1번 |
| 내일 비 옴 | 0.3 (30%) | 10일 중 3일 정도 |
| 태양이 동쪽에서 뜸 | 1.0 (100%) | 확실 |

### 수학적 정의

$$
P(A) = \frac{\text{사건 A가 일어나는 경우의 수}}{\text{전체 경우의 수}}
$$

**예시**: 주사위에서 짝수가 나올 확률

$$
P(\text{짝수}) = \frac{\\{2, 4, 6\\}}{\\{1, 2, 3, 4, 5, 6\\}} = \frac{3}{6} = 0.5
$$

---

## 2. 확률의 기본 규칙

### 규칙 1: 확률은 0 이상

$$
P(A) \geq 0
$$

확률은 음수가 될 수 없습니다. (일어날 가능성이 "마이너스"라는 건 말이 안 됨)

### 규칙 2: 전체 확률은 1

$$
P(\text{전체}) = 1
$$

모든 가능한 결과를 합하면 100%입니다.

### 규칙 3: "또는"의 확률 (합의 법칙)

두 사건이 **동시에 일어날 수 없으면** (배반 사건):

$$
P(A \text{ 또는 } B) = P(A) + P(B)
$$

**예시**: 주사위에서 1 또는 2가 나올 확률

$$
P(1 \text{ 또는 } 2) = P(1) + P(2) = \frac{1}{6} + \frac{1}{6} = \frac{2}{6} = \frac{1}{3}
$$

---

## 3. 조건부 확률 (가장 중요!)

### 문제 상황: "만약 ~라면?"

> 비가 올 확률이 30%라고 합니다. 근데 지금 하늘에 구름이 잔뜩 끼어 있어요. 그래도 30%일까요?

**정답**: 아니요! **조건**이 달라지면 확률도 달라집니다.

### 정의

> **조건부 확률**: A가 일어났을 때, B가 일어날 확률

$$
P(B|A) = \frac{P(A \cap B)}{P(A)}
$$

- $P(B|A)$: "A가 주어졌을 때 B의 확률" (읽기: "P of B given A")
- $P(A \cap B)$: A와 B가 **동시에** 일어날 확률

### 예시: 카드 뽑기

52장 카드에서 1장을 뽑습니다.

- $P(\text{하트})$ = 13/52 = 1/4 (하트는 13장)
- $P(\text{퀸})$ = 4/52 = 1/13 (퀸은 4장)
- $P(\text{퀸}|\text{하트})$ = ? ("뽑은 카드가 하트일 때, 퀸일 확률")

**풀이**:
- 하트 중에서 퀸은 1장 (하트 퀸)
- 하트는 총 13장
- $P(\text{퀸}|\text{하트}) = \frac{1}{13}$

### 딥러닝에서 조건부 확률

```python
# AI 이미지 분류의 본질
P(고양이 | 이미지) = ?  # 이 이미지가 주어졌을 때, 고양이일 확률

# 모델 출력
probs = model(image)  # [0.95, 0.03, 0.02]
# P(고양이|이미지) = 0.95
# P(강아지|이미지) = 0.03
# P(새|이미지) = 0.02
```

**핵심**: 딥러닝 분류 = **조건부 확률 예측**!

---

## 4. 결합 확률과 주변 확률

### 결합 확률 (Joint Probability)

> 두 사건이 **동시에** 일어날 확률

$$
P(A, B) = P(A \cap B) = P(B|A) \cdot P(A)
$$

### 예시: 날씨와 우산

| | 맑음 | 흐림 | 합계 |
|---|:---:|:---:|:---:|
| **우산 O** | 0.05 | 0.25 | 0.30 |
| **우산 X** | 0.45 | 0.25 | 0.70 |
| **합계** | 0.50 | 0.50 | 1.00 |

- **결합 확률**: P(맑음, 우산O) = 0.05 (맑은 날에 우산 가져가는 경우)
- 표 안의 모든 숫자가 결합 확률입니다.

### 주변 확률 (Marginal Probability)

> 결합 확률에서 하나의 변수를 **합산**해서 얻는 확률

$$
P(A) = \sum_B P(A, B)
$$

위 표에서:
- P(우산O) = P(우산O, 맑음) + P(우산O, 흐림) = 0.05 + 0.25 = **0.30**
- P(맑음) = P(맑음, 우산O) + P(맑음, 우산X) = 0.05 + 0.45 = **0.50**

### 왜 "주변"인가?

표의 **가장자리(margin)**에 합계가 적히기 때문입니다!

---

## 5. 독립 (Independence)

### 정의

> 두 사건이 서로 **영향을 주지 않을 때** "독립"

$$
P(A, B) = P(A) \cdot P(B)
$$

또는 동치로:
$$
P(A|B) = P(A)
$$

(B가 일어나든 안 일어나든, A의 확률은 그대로)

### 예시: 독립인 경우

- 동전 두 번 던지기: 첫 번째 결과가 두 번째에 영향 없음
- 서로 다른 두 사람의 생일

### 예시: 독립이 아닌 경우

- 비가 오는 날 우산 가져가기 (비 → 우산 확률 높아짐)
- 공부한 시간과 시험 점수

### 딥러닝에서 독립 가정

```python
# Naive Bayes: 특성들이 독립이라고 가정
P(스팸 | 단어1, 단어2, 단어3)
= P(스팸) × P(단어1|스팸) × P(단어2|스팸) × P(단어3|스팸)

# 실제로는 독립이 아니지만, 이렇게 가정하면 계산이 쉬워짐!
```

---

## 6. 전확률 법칙 (Law of Total Probability)

### 문제 상황

> AI 모델의 전체 정확도는? (쉬운 문제와 어려운 문제가 섞여 있을 때)

### 공식

$$
P(B) = \sum_i P(B|A_i) \cdot P(A_i)
$$

### 예시: AI 정확도 계산

- 쉬운 문제 비율: 70%, 이때 정확도: 95%
- 어려운 문제 비율: 30%, 이때 정확도: 60%

**전체 정확도**:
$$
P(\text{정답}) = 0.95 \times 0.70 + 0.60 \times 0.30 = 0.665 + 0.18 = 0.845
$$

전체 정확도는 **84.5%**!

---

## 코드로 확인하기

```python
import numpy as np

# 결합 확률 테이블 (날씨와 우산 예시)
joint = np.array([
    [0.05, 0.25],  # 우산O: 맑음, 흐림
    [0.45, 0.25]   # 우산X: 맑음, 흐림
])

print("=== 결합 확률 테이블 ===")
print(f"P(맑음, 우산O) = {joint[0, 0]}")
print(f"P(흐림, 우산O) = {joint[0, 1]}")

# 주변 확률 (행/열 합산)
p_umbrella = joint.sum(axis=1)  # 우산 여부별 확률
p_weather = joint.sum(axis=0)   # 날씨별 확률

print("\n=== 주변 확률 ===")
print(f"P(우산O) = {p_umbrella[0]:.2f}")
print(f"P(맑음) = {p_weather[0]:.2f}")

# 조건부 확률
# P(우산O | 흐림) = P(우산O, 흐림) / P(흐림)
p_umbrella_given_cloudy = joint[0, 1] / p_weather[1]
print(f"\n=== 조건부 확률 ===")
print(f"P(우산O | 흐림) = {p_umbrella_given_cloudy:.2f}")

# 독립성 검정
# 독립이면: P(A,B) = P(A) × P(B)
expected_if_independent = p_umbrella[0] * p_weather[0]
actual = joint[0, 0]
print(f"\n=== 독립성 검정 ===")
print(f"P(우산O) × P(맑음) = {expected_if_independent:.4f}")
print(f"P(우산O, 맑음) = {actual:.4f}")
print(f"독립인가? {np.isclose(expected_if_independent, actual)}")
```

**출력**:
```
=== 결합 확률 테이블 ===
P(맑음, 우산O) = 0.05
P(흐림, 우산O) = 0.25

=== 주변 확률 ===
P(우산O) = 0.30
P(맑음) = 0.50

=== 조건부 확률 ===
P(우산O | 흐림) = 0.50

=== 독립성 검정 ===
P(우산O) × P(맑음) = 0.1500
P(우산O, 맑음) = 0.0500
독립인가? False
```

---

## 핵심 정리

| 개념 | 수식 | 한 줄 설명 |
|------|------|----------|
| **확률** | $P(A)$ | 일어날 가능성 (0~1) |
| **조건부 확률** | $P(B\|A)$ | A가 일어났을 때 B의 확률 |
| **결합 확률** | $P(A,B)$ | A와 B가 동시에 일어날 확률 |
| **주변 확률** | $\sum_B P(A,B)$ | 다른 변수 합산해서 얻는 확률 |
| **독립** | $P(A,B) = P(A) \cdot P(B)$ | 서로 영향 없음 |

---

## 딥러닝 연결고리

| 확률 개념 | 딥러닝 적용 |
|----------|-----------|
| 조건부 확률 $P(y\|x)$ | 분류 모델의 출력 (Softmax) |
| 독립 가정 | Naive Bayes, 일부 모델의 단순화 |
| 결합 확률 | 생성 모델 (VAE, Diffusion) |
| 전확률 법칙 | 혼합 모델, 앙상블 |

---

## 다음 단계

조건부 확률을 **역으로** 계산하고 싶다면?
→ [베이즈 정리](/ko/docs/math/probability/bayes)로!

확률을 **숫자**로 다루고 싶다면?
→ [확률 변수](/ko/docs/math/probability/random-variable)로!

---

## 관련 콘텐츠

- [베이즈 정리](/ko/docs/math/probability/bayes) - 조건부 확률의 역산
- [확률 변수](/ko/docs/math/probability/random-variable) - 확률의 함수적 표현
- [확률분포](/ko/docs/math/probability/distribution) - 주요 분포들
